<IfModule mod_rewrite.c>
    RewriteEngine On

    # Base path - leave as / when using a VirtualHost pointing to public/
    RewriteBase /

    # Don't rewrite existing files or directories
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]

    # Rewrite everything else to index.php with the url parameter
    RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]
</IfModule>

# Deny access to sensitive files
<FilesMatch "(\.env|\.htaccess|\.ini|\.log|composer\.json|composer\.lock)$">
    Require all denied
</FilesMatch>

# Prevent directory listing
Options -Indexes
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # Ne pas réécrire les fichiers ou dossiers existants
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]

    # Réécrire le reste vers index.php?url=...
    RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]
</IfModule>

# Cacher les fichiers sensibles
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|inc|bak)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>
